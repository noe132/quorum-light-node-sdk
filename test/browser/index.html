<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test esm bundler</title>
</head>
<body>
  
  <script src="../../dist/quorum-light-node-sdk.esm.js"></script>
  <!-- <script>
    const sleep = (n = 500) =>
      new Promise(resolve => {
        setTimeout(() => {
          resolve();
        }, n);
      });
    // add group
    (async () => {
      try {
        const seedUrl = 'rum://seed?v=1&e=0&n=0&b=Ptpg6HKIRIaTnVw_f3SKvg&c=wPOoSSDCxbk7owipIwJ4nKmRyyN2wRsW1I_vsxZm1dI&g=gTaSO4IDTgi_51DrO1WOLA&k=Aqa6ngNxgrVhf2kQc4nA-0Wr4tsWiaBrshZJPujT5B9g&s=GDLJ-TcXuo95q-CsUFty7pvMIYZRFRQ3VwrparvjKy00wIYSmx5pl4xT4ALb6AVgNei_is5kn1MuXfh9b5wB-QE&t=Fv89llMDYIA&a=%E8%81%8A%E5%A4%A9%E5%AE%A45&y=group_timeline&u=http://103.61.39.166:9003';
        const result = QuorumLightNodeSDK.cache.Group.add(seedUrl, {
          nodeToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhbGxvd0dyb3VwcyI6W10sImV4cCI6MTY1OTcwNDI2NCwibmFtZSI6Im5vZGUtYWxsLWdyb3VwcyIsInJvbGUiOiJjaGFpbiJ9.mHeMhunwDGmjnB7PhoKqVrUZI7QbfaGxOPgH2o4WUQo'
        });
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // { groupId: '8136923b-8203-4e08-bfe7-50eb3b558e2c' }
    // get group
    (async () => {
      try {
        const groupId = '8136923b-8203-4e08-bfe7-50eb3b558e2c';
        const result = QuorumLightNodeSDK.cache.Group.get(groupId);
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // {
    //   appKey: "group_timeline"
    //   chainAPIs: ['http://103.61.39.166:9003']
    //   cipherKey: "c0f3a84920c2c5b93ba308a92302789ca991cb2376c11b16d48fefb31666d5d2"
    //   consensusType: "poa"
    //   encryptionType: "public"
    //   groupId: "8136923b-8203-4e08-bfe7-50eb3b558e2c"
    //   groupName: "聊天室5"
    //   nodeToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhbGxvd0dyb3VwcyI6W10sImV4cCI6MTY1OTcwNDI2NCwibmFtZSI6Im5vZGUtYWxsLWdyb3VwcyIsInJvbGUiOiJjaGFpbiJ9.mHeMhunwDGmjnB7PhoKqVrUZI7QbfaGxOPgH2o4WUQo'
    //   ownerPubKey: "Aqa6ngNxgrVhf2kQc4nA-0Wr4tsWiaBrshZJPujT5B9g"
    //   signature: "GDLJ+TcXuo95q+CsUFty7pvMIYZRFRQ3VwrparvjKy00wIYSmx5pl4xT4ALb6AVgNei/is5kn1MuXfh9b5wB+QE="
    // }
    // list group
    (async () => {
      try {
        const result = QuorumLightNodeSDK.cache.Group.list();
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // [
    //   {
    //     appKey: "group_timeline"
    //     chainAPIs: ['http://103.61.39.166:9003']
    //     cipherKey: "c0f3a84920c2c5b93ba308a92302789ca991cb2376c11b16d48fefb31666d5d2"
    //     consensusType: "poa"
    //     encryptionType: "public"
    //     groupId: "8136923b-8203-4e08-bfe7-50eb3b558e2c"
    //     groupName: "聊天室5"
    //     nodeToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhbGxvd0dyb3VwcyI6W10sImV4cCI6MTY1OTcwNDI2NCwibmFtZSI6Im5vZGUtYWxsLWdyb3VwcyIsInJvbGUiOiJjaGFpbiJ9.mHeMhunwDGmjnB7PhoKqVrUZI7QbfaGxOPgH2o4WUQo'
    //     ownerPubKey: "Aqa6ngNxgrVhf2kQc4nA-0Wr4tsWiaBrshZJPujT5B9g"
    //     signature: "GDLJ+TcXuo95q+CsUFty7pvMIYZRFRQ3VwrparvjKy00wIYSmx5pl4xT4ALb6AVgNei/is5kn1MuXfh9b5wB+QE="
    //   }
    // ]
    // update group
    (async () => {
      try {
        const groupId = '8136923b-8203-4e08-bfe7-50eb3b558e2c';
        const group = QuorumLightNodeSDK.cache.Group.get(groupId);
        group.groupName = 'new group name';
        const result = QuorumLightNodeSDK.cache.Group.update(groupId, group);
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // { groupId: '8136923b-8203-4e08-bfe7-50eb3b558e2c' }
    // remove group
    // (async () => {
    //   try {
    //     const groupId = '8136923b-8203-4e08-bfe7-50eb3b558e2c';
    //     const result = QuorumLightNodeSDK.cache.Group.remove(groupId);
    //     console.log(result);
    //   } catch (err) {
    //     console.log(err);
    //   }
    // })();
    // { groupId: '8136923b-8203-4e08-bfe7-50eb3b558e2c' }
    // create trx
    (async () => {
      try {
        const wallet = QuorumLightNodeSDK.ethers.Wallet.createRandom();
        const result = await QuorumLightNodeSDK.chain.Trx.create({
          groupId: '8136923b-8203-4e08-bfe7-50eb3b558e2c',
          object: {
            type: 'Note',
            content: 'send from JavaScript SDK',
          },
          privateKey: wallet.privateKey,
        });
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // { trx_id: '41f1e91e-5604-4539-8dee-7cf7e3ef5046' }
    // get trx
    (async () => {
      try {
        const groupId = '8136923b-8203-4e08-bfe7-50eb3b558e2c';
        const trxId = '41f1e91e-5604-4539-8dee-7cf7e3ef5046';
        const result = await QuorumLightNodeSDK.chain.Trx.get(groupId, trxId);
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // {
    //   Data: "SdujS8K8zv2E6X839+J3tvIzkpYJti44Bw0cZ0weaYA4sTm0Z1rV/raKoa6zBwrAZYM9Zs+QdLS06jCVcaIvZrDqZysuAbTA/0JPmWVcLRdoiipdjAe6ov35f7WgVps6iSKUrw=="
    //   Expired: "1657279269056000000"
    //   GroupId: "8136923b-8203-4e08-bfe7-50eb3b558e2c"
    //   Nonce: "1"
    //   ResendCount: "0"
    //   SenderPubkey: "Ak0RxoYwYhkAfg0ImkLh-ukRIHkoQ-Kw6QCRr_o83bmq"
    //   SenderSign: "Dz436tcTh+NSUjF38oUBjXkIezVfENb/pit9BY1v8jZrjzcwu66YE8OFO9/MzRNIkhgTK2wulfmk51mzJz/9Txs="
    //   StorageType: "CHAIN"
    //   TimeStamp: "1657279239056000000"
    //   TrxId: "41f1e91e-5604-4539-8dee-7cf7e3ef5046"
    //   Type: "POST"
    //   Version: "1.0.0"
    // }
    // list contents
    (async () => {
      try {
        const result = await QuorumLightNodeSDK.chain.Content.list({
          groupId: '8136923b-8203-4e08-bfe7-50eb3b558e2c',
        });
        console.log(result);
      } catch (err) {
        console.log(err);
      }
    })();
    // {
    //   Data: { type: 'Note', content: 'send from JavaScript SDK' }
    //   Expired: 1657279269056000000
    //   GroupId: "8136923b-8203-4e08-bfe7-50eb3b558e2c"
    //   Nonce: 1
    //   SenderPubkey: "Ak0RxoYwYhkAfg0ImkLh-ukRIHkoQ-Kw6QCRr_o83bmq"
    //   SenderSign: "Dz436tcTh+NSUjF38oUBjXkIezVfENb/pit9BY1v8jZrjzcwu66YE8OFO9/MzRNIkhgTK2wulfmk51mzJz/9Txs="
    //   TimeStamp: "1657279239056000000"
    //   TrxId: "41f1e91e-5604-4539-8dee-7cf7e3ef5046"
    //   Version: "1.0.0"
    // }
  </script> -->
</body>
</html>